# TownSquare 批处理文件使用说明

本项目提供了四个批处理文件来简化TownSquare的启动和关闭操作。

## 文件说明

### 基础版本
- `start.bat` - 基础版一键启动脚本
- `stop.bat` - 基础版一键关闭脚本

### 增强版本
- `start_enhanced.bat` - 增强版一键启动脚本（推荐使用）
- `stop_enhanced.bat` - 增强版一键关闭脚本（推荐使用）

## 使用方法

### 启动服务

1. **双击运行启动脚本**
   - 推荐使用 `start_enhanced.bat`
   - 或者使用 `start.bat`

2. **脚本会自动执行以下操作：**
   - 检查Node.js环境
   - 检查npm可用性
   - 检查端口占用情况
   - 安装依赖包（首次运行）
   - 启动WebSocket服务器
   - 启动Vue客户端

3. **启动完成后：**
   - 客户端地址：http://localhost:8080
   - 服务器地址：ws://localhost:8081
   - 浏览器会自动打开客户端页面

### 关闭服务

1. **双击运行关闭脚本**
   - 推荐使用 `stop_enhanced.bat`
   - 或者使用 `stop.bat`

2. **脚本会自动执行以下操作：**
   - 查找并关闭所有Node.js进程
   - 关闭npm进程
   - 关闭Vue开发服务器
   - 关闭WebSocket服务器
   - 关闭相关命令行窗口
   - 检查端口释放情况

## 功能对比

| 功能 | 基础版 | 增强版 |
|------|--------|--------|
| 环境检查 | ✅ | ✅ |
| 依赖安装 | ✅ | ✅ |
| 端口检查 | ❌ | ✅ |
| 详细状态显示 | ❌ | ✅ |
| 错误处理 | 基础 | 完善 |
| 中文支持 | ❌ | ✅ |
| 进程检查 | 基础 | 详细 |

## 注意事项

### 启动前准备
1. 确保已安装Node.js（建议版本 14+）
2. 确保网络连接正常
3. 确保端口8080和8081未被占用

### 常见问题

**Q: 启动失败怎么办？**
A: 
1. 检查Node.js是否正确安装
2. 检查端口是否被占用
3. 尝试手动运行 `npm install`
4. 查看命令行窗口的错误信息

**Q: 关闭后仍有进程残留？**
A:
1. 使用任务管理器手动关闭
2. 运行 `stop_enhanced.bat` 再次尝试
3. 重启计算机

**Q: 端口被占用怎么办？**
A:
1. 使用 `netstat -ano | findstr :8080` 查看占用进程
2. 使用 `taskkill /pid <进程ID> /f` 强制关闭
3. 或者修改服务器配置使用其他端口

## 手动启动方式

如果批处理文件无法正常工作，可以手动启动：

### 启动服务器
```bash
node server/index.js
```

### 启动客户端
```bash
npm run serve
```

## 技术说明

- **WebSocket服务器**: 运行在端口8081，处理实时通信
- **Vue客户端**: 运行在端口8080，提供Web界面
- **依赖管理**: 使用npm管理项目依赖
- **进程管理**: 使用Windows任务管理器API

## 版本信息

- 脚本版本：1.0
- 兼容系统：Windows 10/11
- 依赖项目：TownSquare v2.16.2 